# 项目清理说明

## 清理时间
2025-01-28

## 清理内容

### 删除的文件/目录

#### 临时文件和备份
- `nul` - 空文件
- `backend/nul` - 空文件
- `backend/cognimark.db.backup_*` - 数据库备份文件
- `chat_history.json` - 根目录重复文件
- `cognimark.db` - 根目录重复文件

#### 临时脚本
- `backend/reload_data.py` - 数据重载脚本
- `backend/restart_server.py` - 服务器重启脚本

#### 旧的向量数据库目录
- `backend/chroma_db/` - 旧的products向量存储（已被通用RAG取代）
- `backend/chroma_db_courses/` - 旧的courses向量存储（已被通用RAG取代）

#### 课程专用RAG文件（已被通用RAG取代）
- `backend/agents/course_rag.py` - 课程专用RAG Agent
- `backend/rag/course_vector_store.py` - 课程向量存储

#### 过时文档
- `READM.md` - 重复的README文件
- `项目介绍-RAG统.md` - 过时的项目介绍文档

### 整理的文件

#### 文档集中管理
- `backend/数据库操作指南.md` → `backend/docs/数据库操作指南.md`
- `backend/通用RAG使用指南.md` → `backend/docs/通用RAG使用指南.md`

## 当前文件结构

```
backend/
├── agents/                    # 智能体模块
│   ├── __init__.py
│   ├── product_selection.py   # 产品选择Agent（启发式）
│   ├── marketing_copy.py      # 营销文案Agent
│   └── rag_product_selection.py # RAG产品选择Agent（保留用于兼容）
│
├── api.py                     # FastAPI主入口
├── agents.py                  # 原始Agent定义（向后兼容）
│
├── database/                  # 数据库模块
│   ├── __init__.py
│   ├── crud.py                # CRUD操作
│   ├── db_init.py             # 数据库初始化
│   ├── db_manager.py          # 数据库管理器
│   ├── models.py              # SQLAlchemy模型
│   └── product_store.py       # 产品存储封装
│
├── data_model.py              # 数据模型兼容层
├── config.py                  # 配置文件
│
├── docs/                      # 文档目录（新增）
│   ├── 数据库操作指南.md
│   └── 通用RAG使用指南.md
│
├── llm_providers/             # LLM提供商
│   ├── __init__.py
│   ├── base.py
│   ├── deepseek_provider.py
│   ├── minimax_provider.py
│   └── openai_provider.py
│
├── llm_service.py             # LLM服务统一接口
│
├── rag/                       # RAG检索模块
│   ├── __init__.py
│   ├── embeddings.py          # 向量嵌入生成
│   ├── rag_config.py          # ⭐ 通用RAG配置文件
│   ├── universal_rag.py       # ⭐ 通用RAG引擎
│   └── vector_store.py        # 向量存储（保留用于兼容）
│
├── services/                  # 服务层
│   └── import_service.py      # 数据导入服务
│
└── README.md                  # 后端说明
```

## 保留的旧文件（用于向后兼容）

以下文件虽然被新的通用RAG取代，但暂时保留以维持向后兼容：

1. **`backend/agents/rag_product_selection.py`** - 旧的RAG产品选择Agent
   - 被 `api.py` 的 `/rag/recommend` 等端点使用
   - 未来可以迁移到通用RAG

2. **`backend/rag/vector_store.py`** - 旧的向量存储
   - 被 `rag_product_selection.py` 使用
   - 未来可以完全移除

3. **`backend/agents.py`** - 原始Agent定义
   - 被 `api.py` 使用
   - 与 `agents/` 目录内容重复，但保持兼容

4. **`backend/data_model.py`** - 数据模型兼容层
   - 简单的wrapper，导出 `database/product_store.py` 的内容

## 未来可以进一步清理的文件

如果完全移除旧的RAG系统支持，可以删除以下文件：

1. `backend/agents/rag_product_selection.py`
2. `backend/rag/vector_store.py`
3. `backend/agents.py`（合并到 `agents/__init__.py`）
4. `api.py` 中的旧RAG相关代码（`init_rag_services`, `/rag/recommend` 等端点）

## 注意事项

- **通用RAG系统**位于 `backend/rag/universal_rag.py`，通过 `backend/rag/rag_config.py` 配置
- **向量数据库**现在存储在 `./chroma_db_universal/` 目录
- 所有配置都在一个文件中：`backend/rag/rag_config.py`
